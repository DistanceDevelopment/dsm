<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Once a DSM has been fitted to data, this function can be used to check for
autocorrelation in the residuals."><title>Check for autocorrelation in residuals — dsm_cor • dsm</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check for autocorrelation in residuals — dsm_cor"><meta property="og:description" content="Once a DSM has been fitted to data, this function can be used to check for
autocorrelation in the residuals."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dsm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3.3.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_format/dsm-data-formatting.html">`dsm` data formatting example</a>
    <a class="dropdown-item" href="../articles/lines_gomex/mexico-analysis.html">Example `dsm` analysis: pantropical dolphins in the Gulf of Mexico</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/distancesamp" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DistanceDevelopment/dsm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Check for autocorrelation in residuals</h1>
      <small class="dont-index">Source: <a href="https://github.com/DistanceDevelopment/dsm/blob/HEAD/R/dsm_cor.R" class="external-link"><code>R/dsm_cor.R</code></a></small>
      <div class="d-none name"><code>dsm_cor.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Once a DSM has been fitted to data, this function can be used to check for
autocorrelation in the residuals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dsm_cor</span><span class="op">(</span></span>
<span>  <span class="va">dsm.obj</span>,</span>
<span>  Transect.Label <span class="op">=</span> <span class="st">"Transect.Label"</span>,</span>
<span>  Segment.Label <span class="op">=</span> <span class="st">"Segment.Label"</span>,</span>
<span>  max.lag <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  resid.type <span class="op">=</span> <span class="st">"scaled.pearson"</span>,</span>
<span>  fun <span class="op">=</span> <span class="va">cor</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="st">"all"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dsm.obj</dt>
<dd><p>a fitted dsm object.</p></dd>


<dt>Transect.Label</dt>
<dd><p>label for the transect (default: <code>Transect.Label</code>).
Using different labels can be useful when transects are split over
geographical features or when transects are surveyed multiple times.</p></dd>


<dt>Segment.Label</dt>
<dd><p>label for the segments (default: <code>Segment.Label</code>).The
result of calling <code><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></code> must make sense.</p></dd>


<dt>max.lag</dt>
<dd><p>maximum lag to calculate at.</p></dd>


<dt>resid.type</dt>
<dd><p>the type of residuals used, see
<code><a href="https://rdrr.io/pkg/mgcv/man/residuals.gam.html" class="external-link">residuals.gam</a></code>. Defaults to <code>"scaled.pearson"</code> in the GAM
case and <code>"normalized"</code> in the GAMM case (which are equivalent).</p></dd>


<dt>fun</dt>
<dd><p>the function to use, by default <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></code>, must take two
column vectors as arguments.</p></dd>


<dt>ylim</dt>
<dd><p>user defined limits in y direction.</p></dd>


<dt>subset</dt>
<dd><p>which subset of the data should the correlation function be
calculated on?</p></dd>


<dt>...</dt>
<dd><p>other options to pass to <code><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a plot or a vector of <code>fun</code> applied at the lags.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Within each <code>Transect.Label</code>, segments will be sorted
according to their <code>Segment.Label</code>s. This may require some time to get right
for your particular data. If one has multiple surveys where transects are
revisited, for example, one may want to make <code>Transect.Label</code> a unique
transect-survey identifier. Neither label need to be included in the model,
they must just be present in the <code>$data</code> field in the model. This usually
means that they have to be in the segment data passed to <code><a href="dsm.html">dsm</a></code>.</p>
<p>The current iteration of this function will only plot correlations nicely,
other things are up to you but you can get the function to return the data
(by assigning the result to an object).</p>
<p>If there are NA values in the residuals then the correlogram will not be
calculated. This usually occurs due to <code>NA</code> values in the covariates (so the
smoother will not have fitted values there). Code like
<code>any(is.na(dsm.obj$data))</code> might be helpful.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>David L. Miller</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/Distance/" class="external-link">Distance</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: 'Distance'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:dsm':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     dummy_ddf</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from 'package:mrds':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     create.bins</span>
<span class="r-in"><span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DistanceDevelopment/dsm" class="external-link">dsm</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># load the data, see ?mexdolphins</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mexdolphins</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># fit a model</span></span></span>
<span class="r-in"><span> <span class="va">hr.model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Distance/man/ds.html" class="external-link">ds</a></span><span class="op">(</span><span class="va">distdata</span>, truncation<span class="op">=</span><span class="fl">6000</span>,</span></span>
<span class="r-in"><span>                key <span class="op">=</span> <span class="st">"hr"</span>, adjustment <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Fitting hazard-rate key function</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> AIC= 677.418</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> No survey area information supplied, only estimating detection function.</span>
<span class="r-in"><span> <span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="dsm.html">dsm</a></span><span class="op">(</span><span class="va">count</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>, <span class="va">hr.model</span>, <span class="va">segdata</span>, <span class="va">obsdata</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some observations are outside of detection function 1 truncation!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># look at lag 1 differences up to a maximum of lag 9, using deviance</span></span></span>
<span class="r-in"><span> <span class="co"># residuals</span></span></span>
<span class="r-in"><span> <span class="fu">dsm_cor</span><span class="op">(</span><span class="va">mod1</span>, resid.type<span class="op">=</span><span class="st">"deviance"</span>, max.lag<span class="op">=</span><span class="fl">9</span>,</span></span>
<span class="r-in"><span>         Segment.Label<span class="op">=</span><span class="st">"Sample.Label"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="dsm_cor-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>We improve our site and software support by using Microsoft Clarity to see <br> how you use our website. By using our site, you agree that we and Microsoft <br> can collect and use this data. Clarity is GDPR compliant.</p>
</div>

<div class="pkgdown-footer-right">
  <p>If you wish to donate to development and maintenance</p>
</div>

    </footer></div>

  

  

  </body></html>

